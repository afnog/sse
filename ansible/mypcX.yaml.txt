---
- hosts: all
  tasks:
  - name: create virtual host file
    template: src=pc36-vhost.j2 dest=/etc/apache2/sites-available/www36.{{ ansible_fqdn }}.conf

  - name: create a shortcut to site-enabled directory 
    command: a2ensite www36.{{ ansible_fqdn }}
    args:
       creates: /etc/apache2/sites-enabled/www36.{{ ansible_fqdn }}.conf
    notify:
        - restart apache2

  - name: create the root directory
    file:
     path: /var/www/html/www36.{{ ansible_fqdn }}
     state: directory

  - name: creating index file
    become: yes
    template:
        src: index.j2
        dest: /var/www/html/www36.{{ ansible_fqdn }}/index.html

  handlers:
  - name: restart apache2
    service:
     name: apache2
     state: restarted
